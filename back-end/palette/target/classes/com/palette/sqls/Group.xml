<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.palette.dao.GroupDao">

<!--   <select id="getAllGroup" resultType="com.palette.model.GroupDto">
    SELECT * FROM GROUP_INFO
  </select> -->
  
  <select id="getBigList" resultType="com.palette.model.InterBigDto">
    SELECT * FROM INTER_BIG
  </select>
  
  <select id="getSmallList" parameterType="java.lang.Integer" resultType="com.palette.model.InterSmallDto">
    SELECT * FROM INTER_SMALL WHERE INTER_BIG_SEQ = #{seq}
  </select>

<!-- group info with schedule -->
	<resultMap type="com.palette.model.GroupDto" id="GroupInfo">
		<id column="GROUP_INFO_SEQ" property="groupInfoSeq"/>
		<result column="MEMBER_SEQ" property="memberSeq"/>
		<result column="INTER_BIG_SEQ" property="interBigSeq"/>
		<result column="INTER_SMALL_SEQ" property="interSmallSeq"/>
		<result column="GROUP_NAME" property="groupName"/>
		<result column="INFO" property="info"/>
		<result column="MAX_MEMBER" property="maxMember"/>
		<result column="IMAGE" property="image"/>
		<result column="START_DATE" property="startDate"/>
		<result column="END_DATE" property="endDate"/>
		<result column="DEL" property="del"/>
		<collection property="groupSchedule" resultMap="GroupSchedule"/>
	</resultMap>
	
	<resultMap type="com.palette.model.GroupSchedule" id="GroupSchedule">
		<id column="GROUP_SCHEDULE_SEQ" property="groupSchedule"/>
		<result column="GROUP_INFO_SEQ" property="groupInfoSeq"/>
		<result column="SUNDAY" property="sunday"/>
		<result column="MONDAY" property="monday"/>
		<result column="TUESDAY" property="tuesday"/>
		<result column="WEDNESDAY" property="wednesday"/>
		<result column="THURSDAY" property="thursday"/>
		<result column="FRIDAY" property="friday"/>
		<result column="SATURDAY" property="saturday"/>
	</resultMap>
<!-- /group info with schedule -->


<!-- group info with Name -->
	<resultMap type="com.palette.model.GroupDto" id="GroupInfoWithName">
		<id column="GROUP_INFO_SEQ" property="groupInfoSeq"/>
		<result column="MEMBER_SEQ" property="memberSeq"/>
		<result column="INTER_BIG_SEQ" property="interBigSeq"/>
		<result column="INTER_SMALL_SEQ" property="interSmallSeq"/>
		<result column="GROUP_NAME" property="groupName"/>
		<result column="INFO" property="info"/>
		<result column="MAX_MEMBER" property="maxMember"/>
		<result column="IMAGE" property="image"/>
		<result column="START_DATE" property="startDate"/>
		<result column="END_DATE" property="endDate"/>
		<result column="DEL" property="del"/>
		<collection property="interBigDto" resultMap="InterBig"/>
		<collection property="interSmallDto" resultMap="InterSmall"/>
		<collection property="memberDto" resultMap="MemberInfo"/>
	</resultMap>
	
	<resultMap type="com.palette.model.InterBigDto" id="InterBig">
		<id column="INTER_BIG_SEQ" property="interBigSeq"/>
		<result column="BIG_NAME" property="bigName"/>
	</resultMap>
	<resultMap type="com.palette.model.InterSmallDto" id="InterSmall">
		<id column="INTER_SMALL_SEQ" property="interSmallSeq"/>
		<result column="INTER_BIG_SEQ" property="interBigSeq"/>
		<result column="SMALL_NAME" property="smallName"/>
	</resultMap>
	
	<select id="getAllGroup" resultMap="GroupInfoWithName">
		select *
		from GROUP_INFO g
		join MEMBER m
		on g.MEMBER_SEQ = m.MEMBER_SEQ
		join INTER_BIG ib
		on g.INTER_BIG_SEQ = ib.INTER_BIG_SEQ
		join INTER_SMALL ism
		on g.INTER_SMALL_SEQ = ism.INTER_SMALL_SEQ
		where g.GROUP_INFO_SEQ = 1;
	</select>
<!-- /group info with Name -->

<select id="getOneGroup" parameterType="java.lang.Integer" resultMap="GroupInfo">
    SELECT i.GROUP_INFO_SEQ, i.MEMBER_SEQ, i.INTER_BIG_SEQ, i.INTER_SMALL_SEQ, i.GROUP_NAME, i.INFO, i.MAX_MEMBER, i.IMAGE, i.START_DATE, i.END_DATE, i.DEL,
    	   s.SUNDAY, s.MONDAY, s.TUESDAY, s.WEDNESDAY, s.THURSDAY, s.FRIDAY, s.SATURDAY
    FROM GROUP_INFO i
    JOIN GROUP_SCHEDULE s
    ON i.GROUP_INFO_SEQ = s.GROUP_INFO_SEQ
    WHERE i.GROUP_INFO_SEQ = #{seq}
</select>


<!-- get Group Member Name -->
	<resultMap type="com.palette.model.GroupMemberDto" id="GroupMember">
		<id column="GROUP_MEMBER_SEQ" property="groupMemberSeq"/>
		<result column="GROUP_INFO_SEQ" property="groupInfoSeq"/>
		<result column="MEMBER_SEQ" property="memberSeq"/>
		<result column="DEL" property="del"/>
		<collection property="memberDto" resultMap="MemberInfo"/>
	</resultMap>
	 
	<resultMap type="com.palette.model.MemberDto" id="MemberInfo">
		<id column="MEMBER_SEQ" property="memberSeq"/>
		<result column="MEMBER_ID" property="memberId"/>
		<result column="MEMBER_NAME" property="memberName"/>
		<result column="BIRTH" property="birth"/>
		<result column="ADDRESS" property="address"/>
		<result column="LOCATION" property="location"/>
		<result column="EMAIL" property="email"/>
		<result column="MYMONEY" property="myMoney"/>
		<result column="CV" property="cv"/>
		<result column="AUTH" property="auth"/>
		<result column="DEL" property="del"/>
		<result column="DISLIKE" property="dislike"/>
	</resultMap> 
	 
	<select id="getGroupMemberName" parameterType="java.lang.Integer" resultMap="GroupMember">
		SELECT g.GROUP_INFO_SEQ, g.MEMBER_SEQ, m.MEMBER_ID, m.MEMBER_NAME, m.BIRTH, m.ADDRESS, m.LOCATION, m.EMAIL, m.MYMONEY, m.CV, m.AUTH, m.DISLIKE
	      FROM GROUP_MEMBER g
		  JOIN MEMBER m
		    ON g.MEMBER_SEQ = m.MEMBER_SEQ 
		 WHERE g.GROUP_INFO_SEQ = #{seq}
	</select>
<!-- /get Group Member Name -->
 
</mapper>